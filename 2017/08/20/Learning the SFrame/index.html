<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>SrtFrmGNU</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="参考课程：机器学习基础：案例研究–华盛顿大学 开发环境搭建，GraphLab Create安装参考：教程1，教程2，以及GraphLab教育版注册链接TIps（注册邮箱中） 黑体部分功能函数具体参考网页：GraphLab Create API DOC1.0   import graphlab    ：启动GraphLab    sf = graphlab.SFrame(‘people-exampl">
<meta property="og:type" content="article">
<meta property="og:title" content="SrtFrmGNU">
<meta property="og:url" content="http://yoursite.com/2017/08/20/Learning the SFrame/index.html">
<meta property="og:site_name" content="SrtFrmGNU">
<meta property="og:description" content="参考课程：机器学习基础：案例研究–华盛顿大学 开发环境搭建，GraphLab Create安装参考：教程1，教程2，以及GraphLab教育版注册链接TIps（注册邮箱中） 黑体部分功能函数具体参考网页：GraphLab Create API DOC1.0   import graphlab    ：启动GraphLab    sf = graphlab.SFrame(‘people-exampl">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://img1.doubanio.com/view/note/large/public/p8947349.jpg">
<meta property="og:updated_time" content="2017-08-09T14:25:52.953Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SrtFrmGNU">
<meta name="twitter:description" content="参考课程：机器学习基础：案例研究–华盛顿大学 开发环境搭建，GraphLab Create安装参考：教程1，教程2，以及GraphLab教育版注册链接TIps（注册邮箱中） 黑体部分功能函数具体参考网页：GraphLab Create API DOC1.0   import graphlab    ：启动GraphLab    sf = graphlab.SFrame(‘people-exampl">
<meta name="twitter:image" content="https://img1.doubanio.com/view/note/large/public/p8947349.jpg">
  
    <link rel="alternate" href="/atom.xml" title="SrtFrmGNU" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">SrtFrmGNU</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Learning the SFrame" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/20/Learning the SFrame/" class="article-date">
  <time datetime="2017-08-20T09:44:15.102Z" itemprop="datePublished">2017-08-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>参考课程：机器学习基础：<a href="https://www.coursera.org/learn/ml-foundations/home/welcome" target="_blank" rel="external">案例研究</a>–华盛顿大学</p>
<p>开发环境搭建，GraphLab Create安装参考：<a href="http://blog.csdn.net/woaidapaopao/article/details/51585803" target="_blank" rel="external">教程1</a>，<a href="http://blog.csdn.net/walkandthink/article/details/45200597" target="_blank" rel="external">教程2</a>，以及GraphLab教育版注册链接TIps（注册邮箱中）</p>
<p>黑体部分功能函数具体参考网页：<a href="https://turi.com/products/create/docs/index.html" target="_blank" rel="external">GraphLab Create API DOC1.0</a></p>
<hr>
<ul>
<li><strong>import</strong> graphlab    ：启动GraphLab </li>
</ul>
<ul>
<li>sf = <strong>graphlab.SFrame</strong>(‘people-example.csv’)    ：导入数据</li>
<li>sf.<strong>tail</strong>()    sf.<strong>head</strong>()</li>
<li>sf.<strong>show</strong>()    ：GraphLab Canvas</li>
<li>graphlab.<strong>canvas</strong>.<strong>set_target</strong>(‘ipynb’)    ：canvas设为在当前的notebook中打开</li>
<li>graphlab.canvas.set_target(‘browser’)    ：canvas设为在浏览器中打开</li>
<li>sf[‘age’].show(<strong>view</strong>=’<strong>Categorical</strong>‘)   ：以分类形式显示‘age’的数据</li>
<li>sf[‘Country’]  ：显示‘Country’中的内容</li>
<li>sf[‘age’].mean()      sf[‘age’].max()</li>
<li>假设定义了transform_country函数（def），对‘Country’数据应用该函数：<ul>
<li>sf[‘Country’].<strong>apply</strong>(transform_country)</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li><p>train_data,test_data=sales.<strong>random_split</strong>(.8,seed=0)    ：按8：2的比例划分sales中数据为train和test</p>
</li>
<li><p>sqft_model = graphlab.<strong>regression</strong>.<strong>create</strong>( train_data,target=’price’,features=[‘sqft_living’], validation_set=None )   ：利用训练集建立现行回归模型</p>
</li>
<li><p>评估所建立的模型（evaluate）</p>
<ul>
<li>sqft_model.<strong>evaluate</strong>(test_data)</li>
</ul>
</li>
<li><p>导入python的matplotlib库绘图（<strong>注意as的作用</strong>）</p>
<ul>
<li>import <strong>matplotlib</strong>.<strong>pyplot</strong> as <strong>plt</strong></li>
<li><strong>%matplotlib inline</strong>  (<em>添加此句用于直接显示plot结果，避免再加一句plt.show()</em>)</li>
</ul>
</li>
<li><p>matplotlib.pyplot的简单应用</p>
<ul>
<li>plt.<strong>plot</strong>(test_data[‘sqft_living’],test_data[‘price’],’.’,test_data[‘sqft_living’],sqft_model.predict(test_data),’-‘)</li>
<li>加一句：plt.show()   #此句的添加因为之前没有添加%matplotlib inline</li>
</ul>
</li>
<li><p>多特征下的回归模型建立</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">my_features = [<span class="string">'bedrooms'</span>, <span class="string">'bathrooms'</span>, <span class="string">'sqft_living'</span>, <span class="string">'sqft_lot'</span>, <span class="string">'floors'</span>, <span class="string">'zipcode'</span>]</div><div class="line">my_features_model = graphlab.linear_regression.create(train_data,target=<span class="string">'price'</span>,features=my_features,validation_set=<span class="keyword">None</span>)</div><div class="line"><span class="comment">#评估两个模型</span></div><div class="line"><span class="keyword">print</span> sqft_model.evaluate(test_data)</div><div class="line"><span class="keyword">print</span> my_features_model.evaluate(test_data)</div></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<ul>
<li>文字分割（计数）<ul>
<li>products[‘count word’] = <strong>graphlab.text_analytics.count_words</strong>(products[‘review’])</li>
</ul>
</li>
<li><strong>len</strong>(products)     ：数据集长度测量</li>
<li>products[‘rating’].show(view = ‘Categorical’)   ：分类Categorical统计products中rating数目</li>
<li>products = products[products[‘rating’] != 3]    ：排除非三星的产品</li>
<li>products[‘sentiments’] = products[‘rating’]&gt;=4     ：分类增加情感sentiment类(<strong>大于3星</strong>)</li>
<li>生成逻辑分类器<ul>
<li>test_data,train_data = products.random_split(0.2,seed=0)</li>
<li>sentiment_model = graphlab.logistic_classifier.create(train_data,target = ‘sentiment’,features = [‘word_count’],validation_set = test_data)</li>
</ul>
</li>
</ul>
<p><strong>AUC：（area under the curve）</strong></p>
<p><strong>ROC（Receiver Operating Characteristic）曲线和AUC常被用来评价一个二值分类器（binary classifier）的优劣，ROC即受试工作曲线，考虑ROC曲线图中的四个点和一条线。第一个点，(0,1)，即FPR=0, TPR=1，这意味着FN（false negative）=0，并且FP（false positive）=0。Wow，这是一个完美的分类器，它将所有的样本都正确分类。第二个点，(1,0)，即FPR=1，TPR=0，类似地分析可以发现这是一个最糟糕的分类器，因为它成功避开了所有的正确答案。第三个点，(0,0)，即FPR=TPR=0，即FP（false positive）=TP（true positive）=0，可以发现该分类器预测所有的样本都为负样本（negative）。类似的，第四个点（1,1），分类器实际上预测所有的样本都为正样本。经过以上的分析，我们可以断言，ROC曲线越接近左上角，该分类器的性能越好。</strong></p>
<div align="center"><br><br><img src="https://img1.doubanio.com/view/note/large/public/p8947349.jpg" alt="ROC_curve"><br><br></div>

<p>利用ROC曲线评估学习好的分类器：</p>
<ul>
<li>sentiment_model.evaluate(test_data,metric = ‘roc_curve’)<ul>
<li>sentiment_model.show(view = ‘Evaluation’)</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li><p>giraffe_reviews[‘predicted_sentiment’] = sentiment_model.predict(giraffe_reviews,output_type = ‘probability’)    ：注意后面的输出类型，原来可以定义输出的类型（这里不是直接的1or0，而是概率）</p>
</li>
<li><p>giraffe_reviews = giraffe_reviews.<strong>sort</strong>(‘predicted_sentiment’, ascending = False)  ：对数据的某一列排序处理，递减应该有：<strong>ascending=False</strong>，递增为：ascending = True</p>
</li>
<li><p>查看第一行，某一列的具体元素为：giraffe_reviews[0][‘review’]</p>
</li>
<li><p>若查看倒数第一行，我们首先会想到len(giraffe_reviews)找到行数，接着数一下，而在python中，可以直接使用<strong>-1</strong>表示倒数第一行。giraffe_reviews[-1][‘review’]</p>
</li>
<li><p><strong>selected_words_model</strong>[‘<strong>coefficients</strong>‘]   ：用于显示所学习模型-selected_words_model的参数</p>
<p>​</p>
</li>
<li><p><strong>TF-IDF</strong>（term frequency–inverse document frequency）是一种用于信息检索与数据挖掘的常用加权技术。TF意思是词频(Term Frequency)，IDF意思是逆向文件频率(Inverse Document Frequency)。</p>
</li>
<li><p>将string / dict / list类型SArrays的内容转换为（word，count）对的字典。</p>
<ul>
<li>obama_word_count = graphlab.text_analytics.count_words(obama[‘text’])</li>
</ul>
</li>
<li><p>将dict / list / array类型的数据，重新分列：</p>
<ul>
<li>obama_word_table = obama[‘word_count’].<strong>stack</strong>(‘word_count’,<strong>new_column_name</strong> = [‘word’,’count’])</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li><p>对全体数据做TFIDF</p>
<ul>
<li><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">people[<span class="string">'word_count'</span>] = graphlab.text_analytics.count_words(people[<span class="string">'text'</span>])</div><div class="line">tfidf = graphlab.text_analytics.tf_idf( people[<span class="string">'word_count'</span>])</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>对个体（Obama）做TFIDF，并进行根据TFIDF结果进行降序排列</p>
<ul>
<li><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">obama = people[people[<span class="string">'name'</span>]=<span class="string">'Barack Obama'</span>]</div><div class="line">obama[[<span class="string">'tfidf'</span>]].stack(<span class="string">'tfidf'</span>,new_column_name=[<span class="string">'word'</span>,<span class="string">'tfidf'</span>]).sort(<span class="string">'ftidf'</span>,ascending=<span class="keyword">False</span>)</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>计算两向量（obama、clinton、backham）之间的<a href="http://www.cnblogs.com/chaosimple/archive/2013/06/28/3160839.html" target="_blank" rel="external">余弦距离</a>，需要注意这里cosin距离的定义为1-<em>*</em></p>
<ul>
<li><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">clinton = people[people[<span class="string">'name'</span>] == <span class="string">'Bill Clinton'</span>]</div><div class="line">beckham = people[people[<span class="string">'name'</span>] == <span class="string">'David Beckham'</span>]</div><div class="line"><span class="comment">######################</span></div><div class="line">graphlab.distances.cosine(obama[<span class="string">'tfidf'</span>][<span class="number">0</span>],clinton[<span class="string">'tfidf'</span>][<span class="number">0</span>])</div><div class="line">graphlab.distances.cosine(obama[<span class="string">'tfidf'</span>][<span class="number">0</span>],beckham[<span class="string">'tfidf'</span>][<span class="number">0</span>])</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>knn_model = graphlab.<strong>nearest_neighbors</strong>.<strong>create</strong>(people,features=[‘tfidf’],label=’name’)   ：创建最近邻模型，label赋值的作用在于query时候，确定返回name的具体值。</p>
</li>
<li><p>knn_model.<strong>query</strong>(obama)   ；询问距离数据集obama最近的人物</p>
</li>
</ul>
<hr>
<ul>
<li><p>对于一个听歌系统，有成千上万的歌曲和听歌用户，从听者众多的歌曲中找出确切的人数：</p>
<ul>
<li>users = song_data[‘user_id’].<strong>unique</strong>()</li>
</ul>
</li>
<li><p>popularity_model = graphlab.<strong>popularity_recomender</strong>.create(train_data, user_id = ‘user_id’, term_id = ‘song’)   ：基于条款流行度进行推荐</p>
</li>
<li><p>为每个人都推荐当前最流行的单曲（推荐内容是一样的）</p>
<ul>
<li>popularity_model.<strong>recommend</strong>(users = [users = [2]])   #users=[3]、[4]、[5]…..结果一样</li>
</ul>
</li>
<li><p>个性化推荐：</p>
<ul>
<li>personality_model = graphlab.<strong>item_similarity_recommender</strong>.create(train_data,user_id=’user_id’,item_id=’song’)</li>
</ul>
</li>
<li><p>推荐实例</p>
<ul>
<li>personality_model.<strong>recommend</strong>(users=[users[0]])   ：某一位用户个性化推荐</li>
<li>personality_model.<strong>get_similar_items</strong>([‘Yellow - Coldplay’])  ：单曲推荐</li>
</ul>
</li>
<li><p>利用AUC曲线定量比较两个模型的性质（popularity_model、personality_model）</p>
<ul>
<li>%matplotlib inline</li>
<li>model_performance = graphlab.recommender.<strong>util</strong>.<strong>compar_models</strong>(test_data, [popularity_model, personality_model], user_sample = 0.05)</li>
</ul>
</li>
<li><p>数据聚合：将数据集song中的被听得最多/最少的歌手统计出来</p>
<ul>
<li>artist_count = song.<strong>groupby</strong>(key_columns=’artist’, operations={‘total_count’: graphlab.aggregate.SUM(‘listen_count’)})</li>
<li>artist_count.sort(‘total_count’,ascending=False)</li>
<li>artist_count.sort(‘total_count’,ascending=True)</li>
</ul>
</li>
<li><p>挑选前1000名不重复的听众朋友</p>
<ul>
<li>test_users = test_data[‘user_id’].<strong>unique( )[0:10000]</strong></li>
<li>对这1000位听众各推荐一首音乐，后计数统计最多的歌曲名单<ul>
<li>recomendatction = personality_model.<strong>recommend</strong>(subset_test_users, <strong>k=1</strong>)</li>
<li>recomendatction.<strong>groupby</strong>(key_columns=’song’,operations={‘count’: graphlab.aggregate.<strong>COUNT</strong>()}).sort(‘count’,ascending=False)</li>
<li>需要说明，上一程序中使用了合计：SFrame.aggregate.COUNT()，区别与之前的.SFrame.aggregate.SUM(‘listen_count’)</li>
</ul>
</li>
</ul>
</li>
<li><p>通过filter_by，过滤源集中的相同的值: image_train.<strong>filter_by</strong>(querry_result[‘reference_label’], ‘id’)</p>
</li>
<li><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>sf = graphlab.SFrame(&#123;<span class="string">'id'</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</div><div class="line"><span class="meta">... </span>                     <span class="string">'animal_type'</span>: [<span class="string">'dog'</span>, <span class="string">'cat'</span>, <span class="string">'cow'</span>, <span class="string">'horse'</span>],</div><div class="line"><span class="meta">... </span>                     <span class="string">'name'</span>: [<span class="string">'bob'</span>, <span class="string">'jim'</span>, <span class="string">'jimbob'</span>, <span class="string">'bobjim'</span>]&#125;)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>household_pets = [<span class="string">'cat'</span>, <span class="string">'hamster'</span>, <span class="string">'dog'</span>, <span class="string">'fish'</span>, <span class="string">'bird'</span>, <span class="string">'snake'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>sf.filter_by(household_pets, <span class="string">'animal_type'</span>)</div><div class="line">+-------------+----+------+</div><div class="line">| animal_type | id | name |</div><div class="line">+-------------+----+------+</div><div class="line">|     dog     | <span class="number">1</span>  | bob  |</div><div class="line">|     cat     | <span class="number">2</span>  | jim  |</div><div class="line">+-------------+----+------+</div></pre></td></tr></table></figure>
</li>
<li><p>Python 小技巧，lambda的使用，编写简单的函数，如：f = lambda x,y,z : x+y+z   print f(1,2,3)  </p>
<ul>
<li>show_neighbors = <strong>lambda</strong> i : get_images_from_ids(knn_model.query(image_train[i:i+1]))</li>
</ul>
</li>
<li><p>image_train[‘label’].<strong>sketch_summary</strong>()  ：统计总和，结果为：</p>
</li>
<li><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Most frequent items:</div><div class="line">+-------+------------+-----+-----+------+</div><div class="line">| value | automobile | cat | dog | bird |</div><div class="line">+-------+------------+-----+-----+------+</div><div class="line">| count |    509     | 509 | 509 | 478  |</div><div class="line">+-------+------------+-----+-----+------+</div></pre></td></tr></table></figure></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/08/20/Learning the SFrame/" data-id="cj6kjqoiu0000fcqn07rfkd7b" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2017/08/20/My-New-Post/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">My New Post?</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/08/20/Learning the SFrame/">(no title)</a>
          </li>
        
          <li>
            <a href="/2017/08/20/My-New-Post/">My New Post?</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Xiaolu Ding<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>